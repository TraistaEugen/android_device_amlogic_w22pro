--- libavformat/avformat.h
+++ libavformat/avformat.h
@@ -42,6 +42,8 @@
 #include "libavcodec/avcodec.h"
 #include "libavutil/dict.h"
 
+#include "divxdrm.h"
+
 #include "avio.h"
 #include "libavformat/version.h"
 
@@ -634,6 +636,13 @@
      * NOT PART OF PUBLIC API
      */
     int request_probe;
+    /**
+     * added by Chen.Zhang
+     * Add this member to mark the offset of the stream in the file
+     */
+     unsigned int stream_offset;
+     int no_extra_offset;
+     float special_fps;  // for some special stream	
 } AVStream;
 
 #define AV_PROGRAM_RUNNING 1
@@ -667,6 +676,8 @@
     AVDictionary *metadata;
 } AVChapter;
 
+#define MAX_STREAMS 30
+
 /**
  * Format I/O context.
  * New fields can be added to the end with minor version bumps.
@@ -695,7 +706,7 @@
      * streams.
      */
     struct AVPacketList *packet_buffer;
-
+	
     /**
      * Decoding: position of the first frame of the component, in
      * AV_TIME_BASE fractional seconds. NEVER set this value directly:
@@ -860,6 +871,25 @@
      * This will be moved into demuxer private options. Thus no API/ABI compatibility
      */
     int ts_id;
+    /* added by Z.C for m2ts files */
+    int orig_packet_size;
+
+    /* added by Z.C for index building */
+    int index_builded;
+
+    /* added by Z.C for some ps/ts file seeking */
+    int64_t valid_offset;
+    int valid_offset_done;
+
+    /* added by Z.C for avi or some other files seekable */
+    int seekable;	
+
+	uint64_t video_avg_frame_time, audio_avg_frame_time;
+
+	//--***********************************************
+    /* added by C.S for divx drm certification:drm information */
+    drm_t       drm;
+//--***********************************************  
 } AVFormatContext;
 
 typedef struct AVPacketList {
@@ -1084,6 +1114,12 @@
                        AVInputFormat *fmt,
                        int buf_size,
                        AVFormatParameters *ap);
+attribute_deprecated int av_open_input_file_header(AVFormatContext **ic_ptr, const char *filename,
+                       AVInputFormat *fmt,
+                       int buf_size,
+                       AVFormatParameters *ap,
+                       const char *headers);
+
 #endif
 
 /**
@@ -1106,6 +1142,7 @@
  * @note If you want to use custom IO, preallocate the format context and set its pb field.
  */
 int avformat_open_input(AVFormatContext **ps, const char *filename, AVInputFormat *fmt, AVDictionary **options);
+int avformat_open_input_header(AVFormatContext **ps, const char *filename, AVInputFormat *fmt, AVDictionary **options,const char * headers);
 
 int av_demuxer_open(AVFormatContext *ic, AVFormatParameters *ap);
 
