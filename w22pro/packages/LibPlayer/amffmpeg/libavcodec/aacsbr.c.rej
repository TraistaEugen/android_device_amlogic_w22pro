--- libavcodec/aacsbr.c
+++ libavcodec/aacsbr.c
@@ -37,7 +37,7 @@
 #include <stdint.h>
 #include <float.h>
 #include <math.h>
-
+#define log2f(x) (x)
 #define ENVELOPE_ADJUSTMENT_OFFSET 2
 #define NOISE_FLOOR_OFFSET 6.0f
 
@@ -1058,10 +1058,14 @@
 
     sbr->reset = 0;
 
+
+/*	CHANGED by zz ,ignore changed sample_rate for SBR;
+	
+*/
     if (!sbr->sample_rate)
-        sbr->sample_rate = 2 * ac->m4ac.sample_rate; //TODO use the nominal sample rate for arbitrary sample rate support
+        sbr->sample_rate = ac->m4ac.sample_rate; // 2 * ac->m4ac.sample_rate; //TODO use the nominal sample rate for arbitrary sample rate support
     if (!ac->m4ac.ext_sample_rate)
-        ac->m4ac.ext_sample_rate = 2 * ac->m4ac.sample_rate;
+        ac->m4ac.ext_sample_rate =ac->m4ac.sample_rate;// 2 * ac->m4ac.sample_rate;
 
     if (crc) {
         skip_bits(gb, 10); // bs_sbr_crc_bits; TODO - implement CRC check
